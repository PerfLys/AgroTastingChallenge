---
import Layout from "@/layouts/Layout.astro";
import PageHeader from "@/components/elements/PageHeader.astro";
import MarkdownContent from "@/components/elements/MarkdownContent.astro";
import PhotoGallery from "@/components/editions/PhotoGallery.astro";
import OptimizedImg from "@/components/elements/OptimizedImg.astro";
import atcData from "@/content/pages/atc.json";

const { titleFr, descriptionFr, bodyFr, coverImage, photos } = atcData;
const photoList = Array.isArray(photos) ? photos : [];
---

<Layout title={titleFr}>
  <div class="site-container mx-auto px-4 mt-10">
    <PageHeader
      title={titleFr}
      description={descriptionFr}
    />

    <div class="inner-container mx-auto">
      <section class="rounded-3xl border border-dashed border-neutral-200 dark:border-neutral-700 bg-white/70 dark:bg-neutral-950/30 backdrop-blur-sm p-6 sm:p-8">
        {coverImage && (
          <OptimizedImg
            src={coverImage}
            alt=""
            width={1200}
            height={675}
            fit="cover"
            quality={78}
            class="w-full h-auto rounded-2xl border border-neutral-200 dark:border-neutral-700 object-cover aspect-[16/9]"
            loading="eager"
            decoding="async"
            fetchpriority="high"
            sizes="(max-width: 1024px) 100vw, 1024px"
          />
        )}

        <MarkdownContent content={bodyFr} className="mt-6" />

        <div class="mt-8 grid grid-cols-1 sm:grid-cols-3 gap-3">
          <a
            href="/atc/deroulement"
            class="rounded-2xl border border-primary/20 hover:border-primary/35 bg-bg-secondary/60 dark:bg-bg-secondary/10 p-5 transition-colors"
          >
            <div class="font-medium text-neutral-800 dark:text-neutral-100">Déroulement</div>
            <div class="mt-1 text-xs text-neutral-600 dark:text-neutral-400">Les étapes de l’événement</div>
          </a>
          <a
            href="/atc/participants"
            class="rounded-2xl border border-primary/20 hover:border-primary/35 bg-bg-secondary/60 dark:bg-bg-secondary/10 p-5 transition-colors"
          >
            <div class="font-medium text-neutral-800 dark:text-neutral-100">Qui participe ?</div>
            <div class="mt-1 text-xs text-neutral-600 dark:text-neutral-400">Participants, équipes, jury</div>
          </a>
          <a
            href="/atc/reglement"
            class="rounded-2xl border border-primary/20 hover:border-primary/35 bg-bg-secondary/60 dark:bg-bg-secondary/10 p-5 transition-colors"
          >
            <div class="font-medium text-neutral-800 dark:text-neutral-100">Règlement</div>
            <div class="mt-1 text-xs text-neutral-600 dark:text-neutral-400">Règles et informations</div>
          </a>
        </div>

        {photoList.length > 0 && (
          <div class="mt-10">
            <PhotoGallery
              photos={photoList}
              altPrefix="Photo"
              previewTitle="Aperçu"
              closeLabel="Fermer"
              viewPhotoLabelPrefix="Voir la photo"
              prevLabel="Précédent"
              nextLabel="Suivant"
            />
          </div>
        )}
      </section>
    </div>
  </div>
</Layout>


