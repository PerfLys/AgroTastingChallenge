---
import Layout from "@/layouts/Layout.astro";
import PageHeader from "@/components/elements/PageHeader.astro";
import OptimizedImg from "@/components/elements/OptimizedImg.astro";
import partenairesData from "@/content/pages/partenaires.json";

export async function getStaticPaths() {
  const partnersList = (partenairesData as any)?.partnersList ?? [];
  return partnersList
    .filter((p: any) => typeof p?.slug === "string" && p.slug.length > 0)
    .map((p: any) => ({ params: { slug: p.slug } }));
}

const slug = Astro.params.slug;
const partnersList = (partenairesData as any)?.partnersList ?? [];
const partner = partnersList.find((p: any) => p?.slug === slug);

if (!partner) {
  return Astro.redirect("/404");
}

const title = partner?.name || "Partner";
const description = partner?.descriptionEn || "";
const websiteUrl = partner?.websiteUrl || "";
const logo = partner?.logo || "";
---

<Layout title={title}>
  <div class="site-container mx-auto px-4 mt-10">
    <PageHeader title={title} description={description || "Partner"} />

    <div class="inner-container mx-auto">
      <section class="rounded-3xl border border-dashed border-neutral-200 dark:border-neutral-700 bg-white/70 dark:bg-neutral-950/30 backdrop-blur-sm p-6 sm:p-8">
        <div class="flex flex-col items-center gap-6">
          <div class="w-full max-w-xs rounded-2xl border border-neutral-200 dark:border-neutral-700 bg-white/60 dark:bg-neutral-950/20 p-6 sm:p-8">
            {logo ? (
              <OptimizedImg
                src={logo}
                alt={title}
                width={512}
                height={256}
                class="mx-auto h-32 w-auto object-contain"
                loading="eager"
                sizes="(max-width: 640px) 100vw, 320px"
                fit="contain"
                quality={80}
              />
            ) : (
              <div class="h-32 flex items-center justify-center text-5xl text-neutral-300">
                <span class="sr-only">Logo</span>
                ❖
              </div>
            )}
          </div>

          {websiteUrl && (
            <div>
              <a
                href={websiteUrl}
                target="_blank"
                rel="noopener noreferrer"
                class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-primary bg-primary/10 hover:bg-primary/20 rounded-lg transition-colors"
              >
                Visit website
                <span aria-hidden="true">→</span>
              </a>
            </div>
          )}
        </div>
      </section>
    </div>
  </div>
</Layout>



